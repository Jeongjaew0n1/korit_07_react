## Backendì—ì„œ ë°ì´í„° ê°€ì ¸ ì˜¤ê¸°

í˜„ì¬ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— Car ë°ì´í„°ì˜ íƒ€ì…ì„ ì •ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ìƒˆ íŒŒì¼ë“¤ì„ ë‹¤ ëª¨ì•„ë†“ê³ , ê±°ê¸°ì„œ í•„ìš”í•œ íƒ€ì…ë“¤ë§Œ importí•´ì„œ ë¹¼ì˜¬ ìˆ˜ ìˆë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```ts
export type CarResponse = {
  brand: string;
  model: string;
  color: string;
  registrationNumber: string;
  modelYear: number;
  price: number;
  _links: {
    self: {
      href:string;
    },
    car: {
      href:string;
    },
    owner: {
      href:string;
    }
  }
}
```
jsonì—ì„œ ìë™ì°¨ elementë¥¼ í™•ì¸í•˜ì—¬ í”„ë¡ íŠ¸ì—”ë“œ ìƒì—ì„œì˜ CarResponse typeì„ ì •ì˜í–ˆìŠµë‹ˆë‹¤. ì—¬ëŸ¬ ëŒ€ì˜ ì°¨ë¥¼ ê°€ì§€ê³  ì˜¤ê³  ì‹¶ìœ¼ë©´ CarResponse[]ê°€ ë˜ê² ë„¤ìš”.

ì´í›„ localhost:8080/api/cars ì—”ë“œí¬ì¸íŠ¸ì—ì„œ GET ìš”ì²­ì„ í•´ì„œ ë°±ì—”ë“œì—ì„œ ìë™ì°¨ë“¤ì„ ê°€ì ¸ì˜¬ê²ë‹ˆë‹¤. ê·¸ëŸ¼ í•¨ìˆ˜ê°€ ìˆì–´ì•¼í•©ë‹ˆë‹¤.

Carlist.tsx
```tsx
import axios from "axios";
import { CarResponse } from "../types";
import { useQuery } from "@tanstack/react-query";

function Carlist() {
  const getCars = async(): Promise<CarResponse[]> => {
    const response = await axios.get("http://localhost:8080/api/cars");
    
    return response.data._embedded.cars;
  }

  const { data, error, isSuccess } = useQuery({
    queryKey: ['cars'],
    queryFn: getCars
  });

  if(!isSuccess) {
    return <span>Loading...â±ï¸</span>
  }

  if (error) {
    return <span>ìë™ì°¨ë“¤ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤...ğŸ˜…</span>
  }
  else {
    return (
      <table>
        <tbody>
          {
            data.map((car: CarResponse) =>
            <tr key={car._links.self.href}>
              <td>{car.brand}</td>
              <td>{car.model}</td>
              <td>{car.color}</td>
              <td>{car.registrationNumber}</td>
              <td>{car.modelYear}</td>
              <td>{car.price}</td>
            </tr>)
          }
        </tbody>
      </table>
    )
  }
}

export default Carlist;
```

# í™˜ê²½ ë³€ìˆ˜ ì´ìš©
ì„œë²„ URLì€ CRUD ê¸°ëŠ¥ì„ ë§Œë“¤ ë•Œ ì†ŒìŠ¤ ì½”ë“œì—ì„œ ì—¬ëŸ¬ ë²ˆ ë°˜ë³µë  ìˆ˜ ìˆìœ¼ë©°, ë°±ì—”ë“œê°€ ë°°í¬ê°€ ë˜ë©´ localhost:8080ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— í™˜ê²½ ë³€ìˆ˜ë¡œ ë¯¸ë¦¬ ì •ì˜í•´ë‘ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ì„œ ìˆ˜ì •ì´ ì´ë£¨ì–´ì§€ê³  ë‚˜ë©´ ê°±ì‹ ëœ GetCars()ê°€ ë‹¤ì‹œ ìš”ì²­ë˜ì–´ì•¼ í• ê²ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ìˆ˜ì • ë¶€ë¶„ì— ìˆëŠ” localhost:8080ê³¼ ë‹¤ì‹œ getCars()ë¥¼ ìš”ì²­í•  ë•Œì˜ localhost:8080ì„ ë§¤ë²ˆ URLë¡œ ì „ë¶€ ë‹¤ ê³ ì¹˜ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤. ê·¸ë˜ì„œ í™˜ê²½ë³€ìˆ˜ì— URLì„ ì €ì¥í•´ë‘ê²Œ ë˜ë©´, URLì´ ë°”ë€” ë•Œ í™˜ê²½ ë³€ìˆ˜ë§Œ ìˆ˜ì •í•´ì£¼ë©´ ì¼ê´„ ë³€í™˜ì´ ë  ê²ƒì´ê¸° ë•Œë¬¸ì— í™˜ê²½ ë³€ìˆ˜ ì„¤ì •ì„ ë¯¸ë¦¬ í•˜ê³  ë‹¤ìŒ ê³¼ì •ìœ¼ë¡œ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤. vite project ìƒì—ì„œëŠ” í™˜ê²½ ë³€ìˆ˜ ì´ë¦„ì€ `VITE_`ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤. ì ‘ë‘ì‚¬ê°€ VITE_ì¸ ë³€ìˆ˜ë§Œ ì†ŒìŠ¤ ì½”ë“œì—ì„œ ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

1. ì•±ì˜ ë£¨íŠ¸ í´ë”ì— `.env` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.
`VITE_API_URL=http://localhost:8080`
2. src í´ë” ë‚´ì— api í´ë” ìƒì„± -> carapi.ts íŒŒì¼ ìƒì„±
  - ì´ìƒì€ ëª¨ë“  API í˜¸ì¶œ í•¨ìˆ˜ë¥¼ ìì²´ ëª¨ë“ˆë¡œ ë¶„ë¦¬í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. ì¦‰ í˜„ì¬ ìƒí™©ì—ì„œëŠ” getCars()ë¥¼ Carlist ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶„ë¦¬í•´ì˜¤ê² ë‹¤ëŠ” ì˜ë¯¸ê°€ ë˜ê² ìŠµë‹ˆë‹¤.

- .env íŒŒì¼ì´ src ë‚´ë¶€ì— ìˆëŠ” ê²½ìš°ê°€ ë§ì•˜ìŠµë‹ˆë‹¤. ê°€ì¥ ìƒìœ„ì— ë‘˜ ê²ƒ.

## í˜ì´ì§• / í•„í„°ë§ / ì •ë ¬ ì¶”ê°€
- github ë•ŒëŠ” AG Grid ì»ëŠ”ë°, ì´ë²ˆì—ëŠ” MUI ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.

## ì‚­ì œ ê¸°ëŠ¥ ì¶”ê°€
- ì‚­ì œë¥¼ í•˜ê¸° ìœ„í•´ì„œëŠ” íŠ¹ì • rowë¥¼ ì„ íƒí•´ì•¼ í•œë‹¤ëŠ” ì ê³¼, ì—”ë“œí¬ì¸íŠ¸ì— {id}ê°€ ì¶”ê°€ë˜ì–´ì•¼ í•œë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ë˜í•œ ê° rowëŠ” hrefë¥¼ ê°€ì§€ê³  ìˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤.
```json
{
  "brand": "Kia",
  "model": "Seltos",
  "color": "Chacol",
  "registrationNumber": "370SU5690",
  "modelYear": 2020,
  "price": 30000000,
  "_links": {
    "self": {
      "href": "http://localhost:8080/api/cars/1"
    },
    "car": {
      "href": "http://localhost:8080/api/cars/1"
    },
    "owner": {
      "href": "http://localhost:8080/api/cars/1/owner"
    }
  }
}
```
HATEOASë¥¼ ì ìš©í–ˆê¸° ë•Œë¬¸ì— ê°ê°ì˜ idê°’ì´ ìë™ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤. ì¦‰ DELETE methodë¥¼ _links.self.hrefë¡œ ë³´ë‚´ì£¼ë©´ ì•Œì•„ì„œ ì‚­ì œê°€ ë ê±°ë¼ê³  ìƒê°í•  ìˆ˜ ìˆê² ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ í˜„ì¬ GET ìš”ì²­ì„ í†µí•´ì„œ `import.meta.env.VITE_API_URL/api/cars`ë¥¼ í•˜ê²Œ ëì„ ë•Œ x-data-gridì— ì˜í•´ì„œ ê° ìë™ì°¨ rowë“¤ì´ ë‚˜ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. x-data-girdì˜ GridColDefë¥¼ ìˆ˜ì •í•˜ì—¬ ë²„íŠ¼ì„ í•˜ë‚˜ ì¶”ê°€í•˜ê³ , ê±°ê¸°ì— ì‚­ì œ ê¸°ëŠ¥ì„ ì ìš©í• ê²ë‹ˆë‹¤. key ì†ì„±ì— ì´ë¯¸ _link.self.href ê°’ì´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

GridColDefì— ìˆëŠ” columns ìƒìˆ˜ë¥¼ ìˆ˜ì •í•˜ì—¬ í•˜ë‚˜ì˜ columnì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì— Delete ë²„íŠ¼ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì»¬ëŸ¼ë“¤ê³¼ ë‹¬ë¦¬ ì„¸ì„¸í•œ ì»¤ìŠ¤í…€ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— renderCell ì»¬ëŸ¼ ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ì…€ì˜ ì»¨í…ì¸ ê°€ ë Œë”ë§ë˜ëŠ” ë°©ì‹ì„ ì •ì˜í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  í˜„ì¬ alertë¥¼ í†µí•´ _links.self.hrefë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ì§€ë¥¼ í™•ì¸í–ˆëŠ”ë°, ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ì ì´ `onClick={alert(params.row._links.self.href)}`ë¥¼ ì“°ê²Œ ë˜ë©´ ì• ì´ˆì— í•¨ìˆ˜ì˜ ê²°ê³¼ê°’ì´ ì¶œë ¥ë ê±°ê¸° ë•Œë¬¸ì— ë²„íŠ¼ì„ ëˆ„ë¥´ëŠ” ê²ƒê³¼ëŠ” ìƒê´€ì´ ì—†ë‹¤ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¬ê²ë‹ˆë‹¤. `onClick={() => alert(_links.self.href)}`ê³¼ì˜ ì°¨ì´ì ì„ ì•Œì•„ì•¼í•©ë‹ˆë‹¤.

í•¨ìˆ˜ì˜ ì´ë¦„ì„ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— ì „ë‹¬ / í•¨ìˆ˜ì˜ ê²°ê³¼ë¥¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— ì „ë‹¬í•˜ëŠ” ê²ƒì˜ ì°¨ì´ì ì„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ë§¤ê°œë³€ìˆ˜ê°€ ì¡´ì¬í•˜ëŠ” í•¨ìˆ˜ì˜ ì´ë¦„ë§Œ ì „ë‹¬í•˜ëŠ” ë°©ë²•ì´ ë¬´ì—‡ì¼ì§€ë¥¼ ê³ ë ¤í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.

button íƒœê·¸ ë‚´ì— sort / filterë¥¼ ë¹„í™œì„±í™” ì‹œì¼°ê³ , ì»¬ëŸ¼ì˜ ë©”ë‰´ë¥¼ ë¹„í™œì„±í™” ì‹œí‚¤ëŠ” disableColumnMenuë¥¼ trueë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  onClick ì´ë²¤íŠ¸ë„ ì„¤ì •í–ˆìŠµë‹ˆë‹¤. ì´ ë‹¤ìŒ ê° rowë“¤ ë§ˆë‹¤ hrefê°€ ì¡´ì¬í•˜ê¸° ë–„ë¬¸ì— delete ìš”ì²­ì„ ë‚ ë¦´ ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

í˜„ì¬ê¹Œì§€ì˜ ì½”ë“œë¥¼ í™•ì¸í•˜ë©´, cardatabase_2ë¥¼ ê¸°ì¤€ìœ¼ë¡œ back-front ì—°ê²°ì„ í•˜ê³  ìˆê³  ì–˜ê°€ Spring Data RESTë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ê³  ìˆìœ¼ë‹ˆ ë¡œì§ ì„¤ëª…ì´ ë˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. ì¦‰, ì½”ë“œ ìì²´ë¥¼ ë³´ê³  ë¡œì§ì„ ë– ì˜¬ë¦¬ê¸° ìœ„í•´ì„œëŠ” cardatabase_5ì˜ CarControllerì™€ CarServiceë¥¼ í™•ì¸í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.

Axiosì˜ delete ë©”ì„œë“œë¥¼ ì´ìš©í•˜ì—¬ DELETE ìš”ì²­ì„ ë³´ë‚¼ê±´ë°, DELETE ìš”ì²­ì˜ ê²½ìš°ì—ëŠ” idê°’ì´ í•„ìš”í•˜ë‹¤ëŠ” ê²ƒì„ CarServiceì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° idê°’ì€ hregì— ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  í•¨ìˆ˜ë“¤ì„ frontendì—ì„œ ë‹¤ ë¶„ë¦¬ë¥¼ í–ˆìŠµë‹ˆë‹¤. deleteCar í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ì•¼í•˜ëŠ” íŒŒì¼ì€ getCarsë¥¼ ì •ì˜í•œ ê³³ì—ì„œ ê°™ì´ ì‘ì„±í•´ì•¼í•©ë‹ˆë‹¤.

```ts
import axios from "axios";
import { CarResponse } from "../types";

export const getCars = async(): Promise<CarResponse[]> => {
  const response = await axios.get(`${import.meta.env.VITE_API_URL}/api/cars`);
  
  return response.data._embedded.cars;
}

export const deleteCar = async(link: string) : Promise<CarResponse[]> => {
  const response = await axios.delete(link);

  return response.data;
}
```
getCars()ì˜ return íƒ€ì…ê³¼ deleteCar()ì˜ return íƒ€ì…ì˜ ì°¨ì´ë¥¼ ìƒê°í•´ì•¼í•©ë‹ˆë‹¤. getCars()ì˜ ê²½ìš° ìë™ì°¨ë“¤ì˜ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ë°°ì—´ë§Œ ê°€ì§€ê³  ì™€ì„œ ê·¸ê²ƒì„ Carlist ì»´í¬ë„ŒíŠ¸ì˜ returnì— í‘œê¸°í•˜ë©´ ë˜ëŠ” ë°˜ë©´ì—, ì‚­ì œ í›„ì—ëŠ” GET ìš”ì²­ ì´í›„ì˜ ì™„ì „í•œ JSONì´ returnë  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ ì°¨ì´ë¡œ ì¸í•´ì„œ ._embedded ìœ ë¬´ê°€ ê²°ì •ë‚©ë‹ˆë‹¤.

## í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
ì‚­ì œë¥¼ í–ˆì„ ë•Œ, cacheë¥¼ í™•ì¸í•˜ì—¬ ìµœì‹  ì •ë³´ë¥¼ ê°€ì§€ê³  ì˜¤ëŠ” ë°©ì‹ì„ íƒí–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ 1ë²ˆ idë¥¼ ê°€ì§€ëŠ” ì• ë¥¼ ì‚­ì œí•œë‹¤ë©´ ë°”ë¡œ ìœ„ì— ë­ê°€ ì—†ì–´ì¡ŒëŠ”ì§€ ë³´ì´ê² ì§€ë§Œ ì¤‘ê°„ì¯¤ì—ì„œ ì‚­ì œë¥¼ í•œë‹¤ë©´ ë Œë”ë§ ëì„ ë•Œ ë‹¤ì‹œ 1ë²ˆ ë¶€í„° ë‚˜ì˜¤ê²Œ ë˜ë‹ˆ ì œëŒ€ë¡œ ì‚­ì œëœê±´ì§€ í™•ì¸í•˜ê¸°ê°€ í˜ë“­ë‹ˆë‹¤. ì¦‰ UXì˜ ê°œì„ ì„ ìœ„í•˜ì—¬ alertê°€ ì•„ë‹Œ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì‚­ì œê°€ ë˜ì—ˆë‹¤ê³  í‘œì‹œë¥¼ í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

### SnackBar
- Modalê³¼ ìœ ì‚¬í•œ ì„±ì§ˆì„ ì§€ë‹ˆê³  ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë™ì¼í•˜ê²Œ `const [ open, setOpen ] = useState(false)`; ê·¸ë ‡ë‹¤ë©´ íŠ¹ì • ìƒí™©ì´ ë°œìƒí–ˆì„ ë•Œ setOpen(true)ë¥¼ í†µí•´ì„œ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ê³ , ë‹¤ì‹œ setOpen(false);ë¥¼ í†µí•´ì„œ ê·¸ ë©”ì‹œì§€ê°€ ì‚¬ë¼ì ¸ì•¼ í•©ë‹ˆë‹¤.

### confirm ìƒì ì¶”ê°€í•˜ê¸°
button íƒœê·¸ ìˆ˜ì •í• ê²ë‹ˆë‹¤.

```tsx
// Carlist.tsx
// import { CarResponse } from "../types"; table íƒœê·¸ì—ì„œëŠ” data.map() ë•Œë¬¸ì— í•„ìš”í–ˆì§€ë§Œ, x-data-grid ì‚¬ìš© ì´í›„ë¡œëŠ” í•„ìš” ì—†ìŠµë‹ˆë‹¤.
import { useQuery, useMutation, useQueryClient } from "@tanstack/react-query";
import { getCars, deleteCar } from "../api/carapi"
import { DataGrid, GridColDef, GridCellParams } from "@mui/x-data-grid";
import { Snackbar } from "@mui/material";
import { useState } from "react";

function Carlist() {
  const queryClient = useQueryClient();
  const [ open, setOpen ] = useState(false);
  
  const { data, error, isSuccess } = useQuery({
    queryKey: ['cars'],
    queryFn: getCars
  });

  const { mutate } = useMutation(deleteCar, {
    onSuccess: () => {
      setOpen(true);
      queryClient.invalidateQueries({ queryKey:[`cars`] }); // ì´ ë¶€ë¶„ì€ useQuery()ë¥¼ ì •ì˜í•œ ë¶€ë¶„ê³¼ ê´€ë ¨ìˆìŠµë‹ˆë‹¤.
    },
    onError: err => {
      console.log(err);
    }
  })

  const columns: GridColDef[] = [
    {field: 'brand', headerName: 'Brand', width: 200},
    {field: 'model', headerName: 'Model', width: 200},
    {field: 'color', headerName: 'Color', width: 200},
    {field: 'registrationNumber', headerName: 'Reg.nr', width: 150},
    {field: 'modelYear', headerName: 'Model Year', width: 150},
    {field: 'price', headerName: 'Price', width: 150},
    {
      field: 'delete',
      headerName: '',
      width: 90,
      sortable: false,
      filterable: false,
      disableColumnMenu: true,
      renderCell: (params: GridCellParams) => (
          <button
            onClick={() => {
              if (confirm(`${params.row.brand}ì˜ ${params.row.model} ìë™ì°¨ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                mutate(params.row._links.self.href);
              }}}>
            Delete
          </button>
      ),
    }
  ]

  if(!isSuccess) {
    return <span>Loading...â±ï¸</span>
  }

  if (error) {
    return <span>ìë™ì°¨ë“¤ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤...ğŸ˜…</span>
  }
  else {
    return (
      <>
        <DataGrid
          rows={data}
          columns={columns}
          getRowId={row => row._links.self.href}
        />
        <Snackbar
          open={open}
          autoHideDuration={2000}
          onClose={()=>setOpen(false)}
          message='ì„ íƒí•œ ìë™ì°¨ ì •ë³´ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.ğŸš“'
        />
      </>
    )
  }
}

export default Carlist;
```

# ìƒì„± ê¸°ëŠ¥ ì¶”ê°€
MUI ëª¨ë‹¬ í¼ì„ ì´ìš©í•˜ì—¬ Car rowë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë„ë¡ í•  ì˜ˆì •ì…ë‹ˆë‹¤. New Carë¼ê³  í•˜ëŠ” ë²„íŠ¼ì„ ì¶”ê°€í•˜ì—¬ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ëª¨ë‹¬ í¼ì´ ì—´ë¦¬ê²Œ í• ê²ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ëª¨ë‹¬ í¼ ë‚´ì—ëŠ” ì—¬ëŸ¬ ê°œì˜ inputì´ ìˆì–´ì„œ entity ìƒì—ì„œ final/@Nonnullì´ ìˆëŠ” fieldì— ëŒ€í•œ ëª¨ë“  ì…ë ¥ì„ ë°›ê³ , ì´ë¥¼ ì €ì¥í•˜ê±°ë‚˜ ì·¨ì†Œí•  ìˆ˜ ìˆëŠ” ë²„íŠ¼ì„ ë‚´ë¶€ì— êµ¬í˜„í•  ì˜ˆì •ì…ë‹ˆë‹¤.

shopping listì—ì„œ add item ë²„íŠ¼ê³¼, ê·¸ ë‚´ë¶€ ëª¨ë‹¬ í¼ í˜•ì‹ì„ ì°¸ì¡°í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

```tsx
//AddCar.tsx
// AddCar.tsx
import { Dialog, DialogActions, DialogContent, DialogTitle } from "@mui/material";
import { Car } from "../types";
import { ChangeEvent, useState } from "react";

function AddCar() {
  const [ open, setOpen ] = useState(false);
  const [ car, setCar ] = useState<Car>({
    brand: '',
    model: '',
    color: '',
    registrationNumber: '',
    modelYear: 0,
    price: 0
  });

  const handleClickOpen = () => setOpen(true);

  const handleClickClose = () => setOpen(false);

  const handleChange = (event: ChangeEvent<HTMLInputElement>) => {
    setCar({...car, [event.target.name]: event.target.value});
  }

  return(
    <>
      <button onClick={handleClickOpen}>New Car</button>
      <Dialog open={open}>
        <DialogTitle>New Car</DialogTitle>
        <DialogContent>
          <input type="text" name="brand" value={car.brand} placeholder="Brand" onChange={handleChange} /><br />
          <input type="text" name="model" value={car.model} placeholder="Model" onChange={handleChange} /><br />
          <input type="text" name="color" value={car.color} placeholder="Color" onChange={handleChange} /><br />
          <input type="text" name="registrationNumber" value={car.registrationNumber} placeholder="Reg.No" onChange={handleChange} /><br />
          <input type="text" name="modelYear" value={car.modelYear} placeholder="Year" onChange={handleChange} /><br />
          <input type="text" name="price" value={car.price} placeholder="Price" onChange={handleChange} /><br />
        </DialogContent>
        <DialogActions>
          <button onClick={handleClickClose}>Cancel | ì·¨ì†Œ</button>
          <button onClick={handleClickClose}>Save | ì €ì¥</button>
        </DialogActions>
      </Dialog>
    </>
  );
}

export default AddCar;
```
ë‚˜ì¤‘ì— ì „ë¶€ html íƒœê·¸ë¥¼ muië¡œ ê°ˆì•„ë¼ìš¸ê²ë‹ˆë‹¤. ê·¸ëŸ¼ í˜„ì¬ê¹Œì§€ì˜ ìƒí™©ì—ì„œ ì´í›„ì˜ ì‘ì„± ìˆœì„œëŠ” axios.postë¥¼ í†µí•´ì„œ dbë¡œ ì§€ê¸ˆ ë°ì´í„°ê°’ì„ ë„˜ê²¨ì„œ ì €ì¥í•  ìˆ˜ ìˆì–´ì•¼ í•  ê²ƒì´ê³ , ì €ì¥ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´ ê°±ì‹ ëœ getCars()ë¥¼ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤.
ë˜í•œ ì €ì¥/ì·¨ì†Œê°€ ëœ ì´í›„ì— inputì°½ì´ ì´ˆê¸°í™”ë˜ëŠ” ê²ƒë„ ê³ ë ¤í•´ë³¼ë§Œí•©ë‹ˆë‹¤. (ê·¸ëŸ¬ë©´ ìˆ˜ì • ë•ŒëŠ” ì´ˆê¸°í™”ëœ inputì´ ì•„ë‹ˆë¼ ê¸°ì¡´ ê°’ë“¤ì´ ë¶ˆëŸ¬ì™€ì ¸ì•¼ê² ë„¤ìš”)


## useMutation

```jsx
import { useMutation } from "@tanstack/react-query";
// useMutationì´ return í•˜ëŠ” ê°ì²´ì—ëŠ” ì´ ì„¸ê°€ì§€ ë§ê³ ë„ ì—¬ëŸ¬ ì†ì„±ê°’ì´ ìˆìŠµë‹ˆë‹¤.
const { data, isLoading, mutate } = useMutation(mutationFn, options);
```

useQueryê°€ GET ìš”ì²­ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ ì˜¤ëŠ”ë° ì‚¬ìš©ëœë‹¤ë©´ useMutationì€ **React Queryë¥¼ ì´ìš©í•´ ì„œë²„ì— ë°ì´í„° ë³€ê²½ ì‘ì—…ì„ ìš”ì²­í•  ë•Œ ì‚¬ìš©**í•©ë‹ˆë‹¤.  `isLoading` ê³¼ `data`ëŠ” useQueryì™€ ê°™ì´ ì™„ë£Œ ì—¬ë¶€ì™€, ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ì§€ë§Œ `mutate`ì€ mutationFnìœ¼ë¡œ ì œê³µëœ í•¨ìˆ˜ë¥¼ ì‘ë™ì‹œí‚¤ëŠ” íŠ¸ë¦¬ê±° í•¨ìˆ˜ì…ë‹ˆë‹¤.

**useMutationì— ë“¤ì–´ê°€ëŠ” ì¸ìˆ˜ ê°’**

1. `mutationFn`:  ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ê³  ì—…ë°ì´íŠ¸í•˜ê³  ì‚­ì œí•˜ëŠ”ë° ì‚¬ìš©í•  í•¨ìˆ˜ì…ë‹ˆë‹¤. fetchë‚˜ axiosë¥¼ ì‚¬ìš©í•˜ì—¬ promiseë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ê°€ ì™€ì•¼í•©ë‹ˆë‹¤.
2. `options`:  useMutationì—ë„ ë§ì€ ì˜µì…˜ì´ ìˆì§€ë§Œ ë§ì´ ì“°ëŠ” 4ê°€ì§€ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤.
    - `onMutate`: Promise ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” Callback í•¨ìˆ˜ë¡œì¨ mutation í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê¸° ì „ì— ì‹¤í–‰ë˜ê³  mutation í•¨ìˆ˜ì™€ ë™ì¼í•œ ë³€ìˆ˜ê°€ ì œê³µë©ë‹ˆë‹¤.
    - `onError`: mutationì´ ì‹¤íŒ¨í•œ ê²½ìš° ì‹¤í–‰í•  Callback í•¨ìˆ˜ ì…ë‹ˆë‹¤.
    - `onSettled`:  mutationì´ ì‹¤íŒ¨ ë˜ëŠ” ì„±ê³µ ì—¬ë¶€ì— ê´€ê³„ ì—†ì´ ì‹¤í–‰í•  Callback í•¨ìˆ˜ ì…ë‹ˆë‹¤.
    - `onSuccess`: mutationì´ ì„±ê³µí•œ ê²½ìš° ì‹¤í–‰í•  Callback í•¨ìˆ˜ ì…ë‹ˆë‹¤.

ì•„ë˜ëŠ” ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œì…ë‹ˆë‹¤.
```jsx
// getPosts  í•¨ìˆ˜ëŠ” ê²Œì‹œë¬¼ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
export const getPosts = async () => {
  const { data }= await axios.get("http://localhost:8080/post");
  return data;
};

// createPost í•¨ìˆ˜ëŠ” ê²Œì‹œë¬¼ì„ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
export const createPost = async (title, content) => {
	await axios.post("http://localhost:8080/post", {
      title,
      content,
    });
};

import { useMutation, useQuery, useQueryClient } from "@tanstack/react-query";
import { getPosts, createPost } from "./api.js"

export default function App() {
	const queryClient = useQueryClient();
	const { isLoading, data: posts } = useQuery("posts", getPosts);
	const createMutate = useMutation(
	    ({ title, content }) => {
	      createPost(title, content);
	    },
	    {
	      onSuccess: () => {
					// ë¹„ë™ê¸° í†µì‹ ì´ ì„±ê³µì ìœ¼ë¡œ ì´ë£¨ì–´ ì¡Œì„ë•Œ
					// posts ë¼ëŠ” queryKeyë¥¼ ì°¾ì•„ ë°ì´í„°ë¥¼ ìƒˆë¡œ ë°›ì•„ì˜µë‹ˆë‹¤.
	        queryClient.invalidateQueries("posts"); 
	      },
	    }
	  );

	const handleSubmit = async (e) => {
    e.preventDefault();
    const { title, content } = e.target;
		
		// ìœ„ì—ì„œ ì„ ì–¸í•œ createMutateì˜ mutateí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ createPost í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤.
    createMutate.mutate({ title: title.value, content: content.value });
  };

  return (
    <div>
			<form onSubmit={handleSubmit}>
			{...ì¤‘ëµ}
			</form>
      {isLoading
        ? "LOADING..."
        : posts.map((post, index) => <div>{`${index}) ${post.title}`}</div>)}
    </div>
  );
}
app.jsx
```
useMutationë¥¼ ì‚¬ìš©í•´ ìƒì„±, ì—…ë°ì´íŠ¸, ì‚­ì œ ë“±ì˜ ì²˜ë¦¬ í•  ìˆ˜ ìˆê³ , queryClientê°€ ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” Query keyë¼ë©´ queryClient.invalidateQueries(queryKey)ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì†ì‰½ê²Œ ê°±ì‹  í•´ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í˜„ì¬ deleteCar() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ useMutation() hookì„ ì ìš©í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ì‚­ì œ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ, ì‚­ì œê°€ DBì—ì„œëŠ” í–ˆì§€ë§Œ frontend ìƒì—ì„œëŠ” ìƒˆë¡œê³ ì¹¨ì„ í•´ì•¼ì§€ë§Œ ì´ë£¨ì–´ì§„ë‹¤ëŠ” ì ë„ í™•ì¸ë©ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ onSuccessëŠ” ì‚­ì œ ì´í›„ì—, ìƒˆë¡œ í”„ë¡ íŠ¸ì—”ë“œì— ê°±ì‹ ë˜ì–´ cars ì •ë³´ë¥¼ ê°€ì§€ê³  ì˜¤ëŠ” ê²ƒì´ ë ê²ë‹ˆë‹¤. ì¦‰, ì´ì œ êµ¬í˜„í•  ë¶€ë¶„ì€ ìë™ì°¨ê°€ ì‚­ì œë˜ë©´ í”„ë¡ íŠ¸ì—”ë“œë¥¼ ìë™ìœ¼ë¡œ ìƒˆë¡œ ê³ ì¹¨í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. react queryì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ëŠ” ì¿¼ë¦¬ í´ë¼ì´ì–¸íŠ¸ê°€ ì²˜ë¦¬í•˜ëŠ” ìºì‹œì— ì €ì¥ë©ë‹ˆë‹¤. ì¿¼ë¦¬ í´ë¼ì´ì–¸íŠ¸ì—ëŠ” ë°ì´í„°ë¥¼ _ë‹¤ì‹œ ê°€ì ¸ì˜¤ëŠ” ë° ì´ìš©í•  ìˆ˜ ìˆëŠ” ì¿¼ë¦¬ ë¬´íš¨í™”_ ê¸°ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤. ë¬¼ë¡  useEffect()ì—ì„œ ì½œë°±í•¨ìˆ˜ë¥¼ í†µí•´ getCars()ë¥¼ í˜¸ì¶œí•˜ëŠ”ë°, `[cars]`ë¥¼ í†µí•´ì„œ carsì˜ ìƒíƒœê°€ ë³€í™”ë  ë•Œê¹Œì§€ ì¬ë Œë”ë§ì„ ì¼ìœ¼í‚¤ëŠ” ë°©ë²•ë„ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° í˜„ì¬ ì‘ì„±í•œ ë°©ì‹ìœ¼ë¡œëŠ”, useStateë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ê³  usequeryë¥¼ í†µí•´ì„œ getCars()ë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ìˆëŠ” ìƒí™©ì´ê¸° ë•Œë¬¸ì— cacheì— cars ë°ì´í„°ê°€ ì €ì¥ë˜ì–´ìˆì„ê±°ë€ ì ì„ ì´ìš©í•´ì„œ ì‘ì„±í• ê²ë‹ˆë‹¤.

ì¿¼ë¦¬ ë¬´íš¨í™” ê¸°ëŠ¥ì„ ì ìš©í•˜ê¸° ìœ„í•´ ë¨¼ì € í˜„ì¬ì˜ ì¿¼ë¦¬ í´ë¼ì´ì–¸íŠ¸ë¥¼ ë°˜í™˜í•˜ëŠ” useQueryClient í›… í•¨ìˆ˜ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.
```tsx
// Carlist.tsx
import { useQuery, useMutation, useQueryClient } from "@tanstack/react-query";
import { getCars, deleteCar } from "../api/carapi"
import { DataGrid, GridColDef, GridCellParams } from "@mui/x-data-grid";

function Carlist() {
  const queryClient = useQueryClient();
  
  const { data, error, isSuccess } = useQuery({
    queryKey: ['cars'],
    queryFn: getCars
  });
```







